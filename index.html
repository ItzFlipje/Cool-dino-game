
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dino Runner PWA</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#ffffff">
  <style>
    body { margin:0; background:#f7f7f7; display:flex; flex-direction:column; align-items:center; justify-content:center; height:100vh; overflow:hidden; font-family:Arial, sans-serif; }
    canvas { background:#fff; border:2px solid #000; }
    .controls { display:flex; justify-content:center; gap:20px; margin-top:10px; }
    button { padding:20px 40px; font-size:20px; border:none; border-radius:10px; background:#000; color:#fff; font-weight:bold; }
  </style>
</head>
<body>
  <canvas id="gameCanvas" width="800" height="200"></canvas>
  <div class="controls">
    <button id="jumpBtn">Jump</button>
    <button id="duckBtn">Duck</button>
  </div>
  <script>
    if('serviceWorker' in navigator){ navigator.serviceWorker.register('sw.js'); }
    const canvas=document.getElementById("gameCanvas"); const ctx=canvas.getContext("2d");
    let dino={x:50,y:150,width:44,height:47,dy:0,gravity:1.2,jumpPower:-15,isJumping:false,isDucking:false};
    let groundY=190; let obstacles=[]; let frame=0; let score=0; let highScore=0; let gameOver=false;
    function resetGame(){ dino.y=150; dino.dy=0; obstacles=[]; score=0; gameOver=false; }
    function jump(){ if(!dino.isJumping&&!gameOver){dino.dy=dino.jumpPower;dino.isJumping=true;} else if(gameOver){resetGame();} }
    function duck(state){ dino.isDucking=state; }
    document.addEventListener("keydown",(e)=>{if(e.code==="Space"||e.code==="ArrowUp")jump();if(e.code==="ArrowDown")duck(true);});
    document.addEventListener("keyup",(e)=>{if(e.code==="ArrowDown")duck(false);});
    document.getElementById("jumpBtn").addEventListener("touchstart",jump);
    document.getElementById("duckBtn").addEventListener("touchstart",()=>duck(true));
    document.getElementById("duckBtn").addEventListener("touchend",()=>duck(false));
    function drawDino(x,y,ducking){ctx.fillStyle="black";ctx.fillRect(x,y,40,30);ctx.fillRect(x+25,y-20,20,20);
      if(!ducking){ctx.fillRect(x+5,y+30,10,15);ctx.fillRect(x+25,y+30,10,15);} else{ctx.fillRect(x,y+15,50,20);}
      ctx.clearRect(x+38,y-15,5,5);}
    function spawnObstacle(){ let type=Math.random()<0.7?"cactus":"ptero"; let yPos=type==="ptero"?groundY-80:groundY-40;
      obstacles.push({x:800,y:yPos,width:type==="ptero"?40:20+Math.random()*20,height:type==="ptero"?20:40,type:type}); }
    function update(){
      if(gameOver)return;
      dino.y+=dino.dy; if(dino.y+dino.height<groundY){dino.dy+=dino.gravity;} else{dino.y=groundY-dino.height;dino.dy=0;dino.isJumping=false;}
      if(frame%120===0){spawnObstacle();}
      obstacles.forEach(ob=>ob.x-=6); obstacles=obstacles.filter(ob=>ob.x+ob.width>0);
      obstacles.forEach(ob=>{if(dino.x<ob.x+ob.width&&dino.x+dino.width>ob.x&&dino.y<ob.y+ob.height&&dino.y+dino.height>ob.y){gameOver=true;highScore=Math.max(score,highScore);}});
      score++; frame++;}
    function draw(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle="#888"; ctx.fillRect(0,groundY,canvas.width,10);
      drawDino(dino.x,dino.y,dino.isDucking);
      ctx.fillStyle="red"; obstacles.forEach(ob=>ctx.fillRect(ob.x,ob.y,ob.width,ob.height));
      ctx.fillStyle="black"; ctx.font="20px Arial"; ctx.fillText("Score: "+score,650,30); ctx.fillText("High: "+highScore,650,60);
      if(gameOver){ctx.fillStyle="black";ctx.font="30px Arial";ctx.fillText("Game Over - Tap Jump to Restart",150,100);}}
    function gameLoop(){update();draw();requestAnimationFrame(gameLoop);}
    gameLoop();
  </script>
</body>
</html>
